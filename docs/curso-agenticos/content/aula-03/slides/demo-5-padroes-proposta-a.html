<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5 Padrões - Proposta A: Escada de Complexidade</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #BE9C6D;
            --gold-light: #d4b896;
            --cream: #FFF4E4;
            --dark: #0a0a12;
            --green: #4ade80;
            --cyan: #22d3ee;
            --purple: #a78bfa;
            --pink: #f472b6;
            --amber: #fbbf24;
            --blue: #60a5fa;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; overflow: hidden; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--dark);
        }

        .bg-gradient {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse 80% 50% at 20% 80%, rgba(190, 156, 109, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse 60% 40% at 80% 20%, rgba(167, 139, 250, 0.06) 0%, transparent 50%),
                var(--dark);
            z-index: 0;
        }

        .container {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            height: 100vh;
            padding: 3vh 4vw;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 2vh;
        }

        .header-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(0.7rem, 0.9vw, 0.85rem);
            color: var(--gold);
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 0.5vh;
        }

        .header-title {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: clamp(1.8rem, 3.5vw, 2.8rem);
            font-weight: 600;
            color: var(--cream);
        }

        .header-subtitle {
            font-family: 'Inter', sans-serif;
            font-size: clamp(0.9rem, 1.2vw, 1.1rem);
            color: rgba(255, 244, 228, 0.6);
            margin-top: 0.5vh;
        }

        /* Main Layout */
        .main-content {
            display: flex;
            flex: 1;
            gap: 3vw;
            align-items: center;
        }

        /* Escada */
        .staircase {
            flex: 0 0 45%;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            height: 70vh;
            position: relative;
        }

        .step {
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            margin-left: calc(var(--step-index) * 4vw);
        }

        .step:hover .step-block {
            transform: translateX(10px);
            box-shadow: 0 0 30px rgba(190, 156, 109, 0.3);
        }

        .step.active .step-block {
            border-color: var(--step-color);
            background: rgba(255, 244, 228, 0.08);
        }

        .step-block {
            display: flex;
            align-items: center;
            gap: 1.5vw;
            background: rgba(20, 20, 30, 0.8);
            border: 2px solid rgba(190, 156, 109, 0.3);
            border-radius: 12px;
            padding: 1.5vh 2vw;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .step-number {
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(1.8rem, 2.5vw, 2.2rem);
            font-weight: 700;
            color: var(--step-color);
            min-width: 50px;
        }

        .step-info {
            flex: 1;
        }

        .step-name {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: clamp(1.1rem, 1.5vw, 1.4rem);
            font-weight: 600;
            color: var(--cream);
            margin-bottom: 0.3vh;
        }

        .step-simple {
            font-family: 'Inter', sans-serif;
            font-size: clamp(0.8rem, 1vw, 0.95rem);
            color: rgba(255, 244, 228, 0.6);
        }

        .step-complexity {
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(0.65rem, 0.8vw, 0.75rem);
            padding: 0.3vh 0.8vw;
            border-radius: 20px;
            background: rgba(255, 244, 228, 0.1);
            color: var(--step-color);
        }

        /* Connector lines */
        .step::before {
            content: '';
            position: absolute;
            left: -2vw;
            top: 50%;
            width: 2vw;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--step-color));
            opacity: 0.4;
        }

        .step:first-child::before {
            display: none;
        }

        /* Detail Panel */
        .detail-panel {
            flex: 1;
            background: rgba(20, 20, 30, 0.6);
            border: 2px solid var(--gold);
            border-radius: 16px;
            padding: 3vh 2.5vw;
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            max-height: 70vh;
            transition: border-color 0.3s ease;
        }

        .detail-header {
            display: flex;
            align-items: center;
            gap: 1.5vw;
            margin-bottom: 2vh;
            padding-bottom: 2vh;
            border-bottom: 1px solid rgba(255, 244, 228, 0.1);
        }

        .detail-number {
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(3rem, 5vw, 4rem);
            font-weight: 700;
            color: var(--gold);
            line-height: 1;
        }

        .detail-titles {
            flex: 1;
        }

        .detail-name {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: clamp(1.6rem, 2.5vw, 2.2rem);
            font-weight: 600;
            color: var(--cream);
        }

        .detail-technical {
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(0.8rem, 1vw, 0.95rem);
            color: var(--gold);
            opacity: 0.8;
        }

        /* Analogia Box */
        .analogy-box {
            background: linear-gradient(135deg, rgba(190, 156, 109, 0.15), rgba(190, 156, 109, 0.05));
            border: 1px solid rgba(190, 156, 109, 0.3);
            border-radius: 12px;
            padding: 2vh 1.5vw;
            margin-bottom: 2vh;
        }

        .analogy-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(0.65rem, 0.8vw, 0.75rem);
            color: var(--gold);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 0.8vh;
        }

        .analogy-text {
            font-family: 'Inter', sans-serif;
            font-size: clamp(1rem, 1.3vw, 1.2rem);
            color: var(--cream);
            line-height: 1.6;
            font-style: italic;
        }

        /* Diagram */
        .diagram-area {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            margin-bottom: 2vh;
            min-height: 120px;
        }

        .diagram-area svg {
            width: 100%;
            max-width: 500px;
            height: 120px;
        }

        /* Example */
        .example-box {
            background: rgba(74, 222, 128, 0.1);
            border: 1px solid rgba(74, 222, 128, 0.3);
            border-radius: 12px;
            padding: 1.5vh 1.5vw;
        }

        .example-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(0.65rem, 0.8vw, 0.75rem);
            color: var(--green);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 0.8vh;
        }

        .example-text {
            font-family: 'Inter', sans-serif;
            font-size: clamp(0.9rem, 1.1vw, 1.05rem);
            color: rgba(255, 244, 228, 0.9);
            line-height: 1.5;
        }

        /* Hint */
        .hint {
            position: fixed;
            bottom: 2vh;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(0.7rem, 0.9vw, 0.85rem);
            color: rgba(255, 244, 228, 0.4);
        }

        /* Complexity indicator */
        .complexity-bar {
            position: absolute;
            right: 3vw;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1vh;
        }

        .complexity-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(0.6rem, 0.7vw, 0.65rem);
            color: rgba(255, 244, 228, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
            writing-mode: vertical-rl;
            text-orientation: mixed;
        }

        .complexity-track {
            width: 4px;
            height: 30vh;
            background: rgba(255, 244, 228, 0.1);
            border-radius: 2px;
            position: relative;
        }

        .complexity-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, var(--amber), var(--purple), var(--pink));
            border-radius: 2px;
            transition: height 0.3s ease;
        }

        /* Animations */
        .step {
            opacity: 0;
            animation: stepSlideIn 0.5s ease forwards;
        }
        .step:nth-child(1) { animation-delay: 0.1s; }
        .step:nth-child(2) { animation-delay: 0.2s; }
        .step:nth-child(3) { animation-delay: 0.3s; }
        .step:nth-child(4) { animation-delay: 0.4s; }
        .step:nth-child(5) { animation-delay: 0.5s; }

        @keyframes stepSlideIn {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Embed mode */
        body.embed-mode .container { padding: 2vh 3vw; }
        body.embed-mode .header-title { font-size: clamp(1.4rem, 2.5vw, 2rem); }
        body.embed-mode .step { margin-left: calc(var(--step-index) * 2.5vw); }
        body.embed-mode .step-block { padding: 1vh 1.5vw; }
        body.embed-mode .detail-panel { padding: 2vh 2vw; }
    </style>
</head>
<body>
    <div class="bg-gradient"></div>

    <div class="container">
        <div class="header">
            <div class="header-label">Building Effective Agents</div>
            <h1 class="header-title">5 Padrões de Workflow Agêntico</h1>
            <p class="header-subtitle">Comece simples. Só suba se precisar.</p>
        </div>

        <div class="main-content">
            <div class="staircase" id="staircase">
                <!-- Steps generated by JS -->
            </div>

            <div class="detail-panel" id="detailPanel">
                <div class="detail-header">
                    <div class="detail-number" id="detailNumber">1</div>
                    <div class="detail-titles">
                        <div class="detail-name" id="detailName">Encadeamento</div>
                        <div class="detail-technical" id="detailTechnical">Prompt Chaining</div>
                    </div>
                </div>

                <div class="analogy-box">
                    <div class="analogy-label">Analogia do Cotidiano</div>
                    <div class="analogy-text" id="analogyText">"Como uma linha de montagem: cada estação faz uma parte e passa para a próxima."</div>
                </div>

                <div class="diagram-area">
                    <svg id="diagram" viewBox="0 0 500 120"></svg>
                </div>

                <div class="example-box">
                    <div class="example-label">Exemplo Jurídico</div>
                    <div class="example-text" id="exampleText">Pipeline de sentença: Relatório → Fundamentação → Dispositivo. Cada etapa usa o resultado da anterior.</div>
                </div>
            </div>

            <div class="complexity-bar">
                <span class="complexity-label">Complexidade</span>
                <div class="complexity-track">
                    <div class="complexity-fill" id="complexityFill" style="height: 20%;"></div>
                </div>
            </div>
        </div>

        <div class="hint">Clique nos degraus ou use ↑↓</div>
    </div>

    <script>
        const patterns = [
            {
                number: 1,
                name: "Encadeamento",
                technical: "Prompt Chaining",
                simple: "Etapas em sequência",
                color: "#fbbf24",
                complexity: 20,
                analogy: '"Como uma linha de montagem: cada estação faz sua parte e passa para a próxima."',
                example: "Pipeline de sentença: Relatório → Fundamentação → Dispositivo. Cada etapa usa o resultado da anterior para construir o documento completo.",
                diagram: `
                    <defs>
                        <marker id="arrow1" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                            <path d="M0,0 L8,4 L0,8 Z" fill="#fbbf24"/>
                        </marker>
                    </defs>
                    <g transform="translate(30, 35)">
                        <rect x="0" y="0" width="100" height="50" rx="8" fill="#fbbf24" opacity="0.8"/>
                        <text x="50" y="30" text-anchor="middle" fill="white" font-size="12" font-weight="600">Relatório</text>

                        <path d="M 110 25 L 140 25" stroke="#fbbf24" stroke-width="3" marker-end="url(#arrow1)"/>

                        <rect x="150" y="0" width="100" height="50" rx="8" fill="#fbbf24" opacity="0.8"/>
                        <text x="200" y="30" text-anchor="middle" fill="white" font-size="12" font-weight="600">Fundament.</text>

                        <path d="M 260 25 L 290 25" stroke="#fbbf24" stroke-width="3" marker-end="url(#arrow1)"/>

                        <rect x="300" y="0" width="100" height="50" rx="8" fill="#fbbf24" opacity="0.8"/>
                        <text x="350" y="30" text-anchor="middle" fill="white" font-size="12" font-weight="600">Dispositivo</text>
                    </g>
                `
            },
            {
                number: 2,
                name: "Roteamento",
                technical: "Routing",
                simple: "Classificar e direcionar",
                color: "#60a5fa",
                complexity: 35,
                analogy: '"Como uma triagem de hospital: cada paciente vai para o especialista certo."',
                example: "Classificador de processos: identifica se é BPC, Aposentadoria ou Auxílio-Doença e direciona para o fluxo especializado.",
                diagram: `
                    <defs>
                        <marker id="arrow2" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                            <path d="M0,0 L8,4 L0,8 Z" fill="#60a5fa"/>
                        </marker>
                    </defs>
                    <g transform="translate(30, 10)">
                        <rect x="0" y="35" width="80" height="40" rx="8" fill="#60a5fa" opacity="0.8"/>
                        <text x="40" y="60" text-anchor="middle" fill="white" font-size="11" font-weight="600">Processo</text>

                        <polygon points="120,55 160,20 160,90" fill="#60a5fa" opacity="0.8"/>
                        <text x="145" y="60" text-anchor="middle" fill="white" font-size="14">?</text>

                        <path d="M 85 55 L 120 55" stroke="#60a5fa" stroke-width="2"/>
                        <path d="M 165 30 L 220 15" stroke="#60a5fa" stroke-width="2" marker-end="url(#arrow2)"/>
                        <path d="M 165 55 L 220 55" stroke="#60a5fa" stroke-width="2" marker-end="url(#arrow2)"/>
                        <path d="M 165 80 L 220 95" stroke="#60a5fa" stroke-width="2" marker-end="url(#arrow2)"/>

                        <rect x="230" y="0" width="100" height="30" rx="6" fill="#60a5fa" opacity="0.6"/>
                        <text x="280" y="20" text-anchor="middle" fill="white" font-size="10">BPC</text>

                        <rect x="230" y="40" width="100" height="30" rx="6" fill="#60a5fa" opacity="0.8"/>
                        <text x="280" y="60" text-anchor="middle" fill="white" font-size="10">Aposentadoria</text>

                        <rect x="230" y="80" width="100" height="30" rx="6" fill="#60a5fa" opacity="0.6"/>
                        <text x="280" y="100" text-anchor="middle" fill="white" font-size="10">Auxílio-Doença</text>
                    </g>
                `
            },
            {
                number: 3,
                name: "Paralelização",
                technical: "Parallelization",
                simple: "Vários ao mesmo tempo",
                color: "#a78bfa",
                complexity: 55,
                analogy: '"Como uma banca de correção: 3 professores corrigem a mesma prova simultaneamente."',
                example: "Revisão tripla de sentença: revisores ortográfico, jurídico e estilístico analisam em paralelo. Resultados consolidados ao final.",
                diagram: `
                    <defs>
                        <marker id="arrow3" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                            <path d="M0,0 L8,4 L0,8 Z" fill="#a78bfa"/>
                        </marker>
                        <marker id="arrow3g" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                            <path d="M0,0 L8,4 L0,8 Z" fill="#4ade80"/>
                        </marker>
                    </defs>
                    <g transform="translate(20, 10)">
                        <rect x="0" y="35" width="70" height="40" rx="8" fill="#a78bfa" opacity="0.8"/>
                        <text x="35" y="60" text-anchor="middle" fill="white" font-size="10" font-weight="600">Sentença</text>

                        <path d="M 75 55 L 110 20" stroke="#a78bfa" stroke-width="2"/>
                        <path d="M 75 55 L 110 55" stroke="#a78bfa" stroke-width="2"/>
                        <path d="M 75 55 L 110 90" stroke="#a78bfa" stroke-width="2"/>

                        <rect x="115" y="5" width="110" height="30" rx="6" fill="#a78bfa" opacity="0.7"/>
                        <text x="170" y="25" text-anchor="middle" fill="white" font-size="9">Ortográfico</text>

                        <rect x="115" y="40" width="110" height="30" rx="6" fill="#a78bfa" opacity="0.7"/>
                        <text x="170" y="60" text-anchor="middle" fill="white" font-size="9">Jurídico</text>

                        <rect x="115" y="75" width="110" height="30" rx="6" fill="#a78bfa" opacity="0.7"/>
                        <text x="170" y="95" text-anchor="middle" fill="white" font-size="9">Estilístico</text>

                        <path d="M 230 20 L 265 55" stroke="#a78bfa" stroke-width="2"/>
                        <path d="M 230 55 L 265 55" stroke="#a78bfa" stroke-width="2"/>
                        <path d="M 230 90 L 265 55" stroke="#a78bfa" stroke-width="2"/>

                        <rect x="270" y="35" width="80" height="40" rx="8" fill="#4ade80" opacity="0.8"/>
                        <text x="310" y="60" text-anchor="middle" fill="white" font-size="10" font-weight="600">Consolidado</text>
                    </g>
                `
            },
            {
                number: 4,
                name: "Orquestrador",
                technical: "Orchestrator-Workers",
                simple: "Chefe delega tarefas",
                color: "#22d3ee",
                complexity: 75,
                analogy: '"Como um maestro: decide quem toca o quê, quando, e combina tudo no final."',
                example: "Pesquisa jurídica adaptativa: orquestrador decide quais bases pesquisar (STF, STJ, TRFs) baseado no tema. Delega e sintetiza.",
                diagram: `
                    <defs>
                        <marker id="arrow4" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                            <path d="M0,0 L8,4 L0,8 Z" fill="#22d3ee"/>
                        </marker>
                    </defs>
                    <g transform="translate(80, 5)">
                        <circle cx="150" cy="25" r="25" fill="#22d3ee" opacity="0.8"/>
                        <text x="150" y="22" text-anchor="middle" fill="white" font-size="8" font-weight="600">Orques-</text>
                        <text x="150" y="32" text-anchor="middle" fill="white" font-size="8" font-weight="600">trador</text>

                        <path d="M 130 45 L 70 75" stroke="#22d3ee" stroke-width="2" stroke-dasharray="4" marker-end="url(#arrow4)"/>
                        <path d="M 150 50 L 150 75" stroke="#22d3ee" stroke-width="2" stroke-dasharray="4" marker-end="url(#arrow4)"/>
                        <path d="M 170 45 L 230 75" stroke="#22d3ee" stroke-width="2" stroke-dasharray="4" marker-end="url(#arrow4)"/>

                        <rect x="20" y="80" width="80" height="30" rx="6" fill="#22d3ee" opacity="0.6"/>
                        <text x="60" y="100" text-anchor="middle" fill="white" font-size="10">STF</text>

                        <rect x="110" y="80" width="80" height="30" rx="6" fill="#22d3ee" opacity="0.6"/>
                        <text x="150" y="100" text-anchor="middle" fill="white" font-size="10">STJ</text>

                        <rect x="200" y="80" width="80" height="30" rx="6" fill="#22d3ee" opacity="0.6"/>
                        <text x="240" y="100" text-anchor="middle" fill="white" font-size="10">TRFs</text>

                        <text x="150" y="70" text-anchor="middle" fill="#22d3ee" font-size="8" opacity="0.7">delega dinamicamente</text>
                    </g>
                `
            },
            {
                number: 5,
                name: "Avaliador",
                technical: "Evaluator-Optimizer",
                simple: "Gera, avalia, refina",
                color: "#f472b6",
                complexity: 95,
                analogy: '"Como um editor de texto: escreve, revisa, reescreve até ficar bom."',
                example: "Maker-Checker jurídico: gerador cria minuta, avaliador verifica conformidade. Loop continua até aprovação ou limite de iterações.",
                diagram: `
                    <defs>
                        <marker id="arrow5" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                            <path d="M0,0 L8,4 L0,8 Z" fill="#f472b6"/>
                        </marker>
                        <marker id="arrow5g" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                            <path d="M0,0 L8,4 L0,8 Z" fill="#4ade80"/>
                        </marker>
                    </defs>
                    <g transform="translate(30, 20)">
                        <rect x="0" y="20" width="100" height="45" rx="8" fill="#f472b6" opacity="0.8"/>
                        <text x="50" y="40" text-anchor="middle" fill="white" font-size="10" font-weight="600">Gerador</text>
                        <text x="50" y="52" text-anchor="middle" fill="white" font-size="8" opacity="0.8">cria minuta</text>

                        <path d="M 110 42 L 150 42" stroke="#f472b6" stroke-width="2" marker-end="url(#arrow5)"/>

                        <rect x="160" y="20" width="100" height="45" rx="8" fill="#f472b6" opacity="0.8"/>
                        <text x="210" y="40" text-anchor="middle" fill="white" font-size="10" font-weight="600">Avaliador</text>
                        <text x="210" y="52" text-anchor="middle" fill="white" font-size="8" opacity="0.8">verifica</text>

                        <path d="M 210 70 Q 210 95 130 95 Q 50 95 50 70" stroke="#f472b6" stroke-width="2" fill="none" stroke-dasharray="5" marker-end="url(#arrow5)"/>
                        <text x="130" y="88" text-anchor="middle" fill="#f472b6" font-size="8">feedback</text>

                        <path d="M 270 42 L 310 42" stroke="#4ade80" stroke-width="2" marker-end="url(#arrow5g)"/>
                        <text x="290" y="35" text-anchor="middle" fill="#4ade80" font-size="8">OK?</text>

                        <rect x="320" y="20" width="80" height="45" rx="8" fill="#4ade80" opacity="0.8"/>
                        <text x="360" y="47" text-anchor="middle" fill="white" font-size="10" font-weight="600">Output</text>
                    </g>
                `
            }
        ];

        let currentStep = 0;

        function renderStaircase() {
            const container = document.getElementById('staircase');
            container.innerHTML = '';

            patterns.forEach((p, i) => {
                const step = document.createElement('div');
                step.className = `step ${i === currentStep ? 'active' : ''}`;
                step.style.setProperty('--step-index', i);
                step.style.setProperty('--step-color', p.color);
                step.dataset.index = i;

                step.innerHTML = `
                    <div class="step-block">
                        <div class="step-number">${p.number}</div>
                        <div class="step-info">
                            <div class="step-name">${p.name}</div>
                            <div class="step-simple">${p.simple}</div>
                        </div>
                        <span class="step-complexity">${p.complexity < 40 ? 'Baixa' : p.complexity < 70 ? 'Média' : 'Alta'}</span>
                    </div>
                `;

                step.addEventListener('click', () => selectStep(i));
                container.appendChild(step);
            });
        }

        function selectStep(index) {
            currentStep = index;
            const p = patterns[index];

            // Update staircase
            document.querySelectorAll('.step').forEach((el, i) => {
                el.classList.toggle('active', i === index);
            });

            // Update detail panel
            document.getElementById('detailNumber').textContent = p.number;
            document.getElementById('detailNumber').style.color = p.color;
            document.getElementById('detailName').textContent = p.name;
            document.getElementById('detailTechnical').textContent = p.technical;
            document.getElementById('analogyText').textContent = p.analogy;
            document.getElementById('exampleText').textContent = p.example;
            document.getElementById('diagram').innerHTML = p.diagram;
            document.getElementById('detailPanel').style.borderColor = p.color;
            document.getElementById('complexityFill').style.height = p.complexity + '%';
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
                selectStep((currentStep + 1) % patterns.length);
            } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
                selectStep((currentStep - 1 + patterns.length) % patterns.length);
            } else if (e.key >= '1' && e.key <= '5') {
                selectStep(parseInt(e.key) - 1);
            }
        });

        // Initialize
        renderStaircase();
        selectStep(0);

        // Embed mode
        try {
            if (window.self !== window.top) {
                document.body.classList.add('embed-mode');
            }
        } catch (e) {
            document.body.classList.add('embed-mode');
        }
    </script>
</body>
</html>
