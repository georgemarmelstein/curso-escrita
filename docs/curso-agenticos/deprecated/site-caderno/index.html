<!DOCTYPE html>
<html lang="pt-BR" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistemas Agenticos - Caderno de Exercicios</title>
    <meta name="description" content="Caderno de exercicios interativo do curso de Sistemas Agenticos para Juristas. Domine o Claude Code e construa sistemas de IA.">
    <meta name="theme-color" content="#194A68">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Agentes">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="assets/icons/icon.svg">
    <link rel="apple-touch-icon" href="assets/icons/icon.svg">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,400;0,600;0,700;1,400&family=Source+Sans+3:ital,wght@0,400;0,500;0,600;0,700;1,400&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/caderno.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="#" class="sidebar-logo" onclick="loadLesson('0'); return false;">
                    <div class="sidebar-logo-icon">SA</div>
                    <div class="sidebar-logo-text">
                        Sistemas Agenticos
                        <span>Caderno de Exercicios</span>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav" id="sidebar-nav">
                <!-- Navigation items will be generated by JavaScript -->
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content" id="main-content">
            <!-- Lesson content will be rendered here -->
        </main>
    </div>

    <!-- Theme Toggle -->
    <button class="theme-toggle" id="theme-toggle" title="Alternar tema (T)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
        </svg>
    </button>

    <!-- Sidebar Toggle (Mobile) -->
    <button class="sidebar-toggle" id="sidebar-toggle">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12h18M3 6h18M3 18h18"/>
        </svg>
    </button>

    <!-- Keyboard Shortcuts Modal -->
    <div class="modal-overlay" id="shortcuts-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Atalhos de Teclado</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="shortcut-row"><span>Proxima licao</span><span class="shortcut-key">J</span></div>
            <div class="shortcut-row"><span>Licao anterior</span><span class="shortcut-key">K</span></div>
            <div class="shortcut-row"><span>Toggle sidebar</span><span class="shortcut-key">B</span></div>
            <div class="shortcut-row"><span>Toggle tema</span><span class="shortcut-key">T</span></div>
            <div class="shortcut-row"><span>Ajuda</span><span class="shortcut-key">?</span></div>
        </div>
    </div>

    <script>
    // ===== LESSONS DATA =====
    const lessons = {
        // ===== MODULO 1: FUNDAMENTOS =====
        "0": {
            number: "0",
            module: "Modulo 1 - Fundamentos",
            title: "Bem-Vindo ao Mundo Agentico",
            objective: "Compreender a mudanca de paradigma do modo assistente para o modo agentico e decidir conscientemente aceitar o chamado a aventura.",
            learningObjectives: [
                "Reconhecer o <strong>valor E as limitacoes</strong> do modo assistente",
                "Compreender o conceito de <strong>sistema agentico vs assistente</strong>",
                "Visualizar os <strong>beneficios de dominar o Claude Code</strong>",
                "Decidir conscientemente se aceita o chamado a aventura"
            ],
            whyItMatters: "O modo assistente ja e incrivel e mudou sua vida profissional. Mas para trabalho real, continuo, em escala, voce precisa de um trabalhador, nao de um conversador. O Claude Code e essa evolucao.",
            content: \`
                <h3>Tres Momentos que Mudaram Tudo</h3>
                <p>Antes de falar para onde vamos, vamos celebrar de onde viemos:</p>
                <ul>
                    <li><strong>2023 - ChatGPT:</strong> Uma maquina que se comunica</li>
                    <li><strong>2025 - Deep Search:</strong> Uma maquina que orquestra maquinas</li>
                    <li><strong>2025 - Claude Code:</strong> Uma maquina que controla maquinas</li>
                </ul>

                <h3>O Modo Assistente Ja E Incrivel</h3>
                <p>O modo assistente JA E INCRIVEL. E voce esta certo em ama-lo:</p>
                <ul>
                    <li>Conversacao natural em portugues</li>
                    <li>Analise de documentos e contratos</li>
                    <li>Pesquisa contextual e brainstorming</li>
                    <li>Redacao assistida de peticoes e pareceres</li>
                </ul>

                <h3>As 7 Limitacoes Criticas</h3>
                <p>Mas quando voce tenta fazer trabalho real, continuo, em escala... esbarra em paredes:</p>
                <ol>
                    <li><strong>Execucao Unitaria:</strong> Um prompt, uma resposta - voce vira o middleware</li>
                    <li><strong>Sincronicidade Forcada:</strong> Enquanto o Claude pensa, voce espera</li>
                    <li><strong>Limitacao de Anexos:</strong> 20 arquivos, 30MB - gargalo para processos grandes</li>
                    <li><strong>Ilusao do Anexo:</strong> Ele nao "le" o documento, le pedacos</li>
                    <li><strong>Colapso do Contexto:</strong> Conversas longas degradam</li>
                    <li><strong>Falta de Memoria:</strong> Cada conversa comeca do zero</li>
                    <li><strong>Inadequacao para Projetos:</strong> Nao funciona para multiplos dias</li>
                </ol>

                <h3>A Revolucao Claude Code</h3>
                <p>O Claude Code e diferente:</p>
                <pre><code class="terminal">
<span class="terminal-comment"># No terminal, o Claude tem acesso ao seu computador</span>
<span class="terminal-prompt">$</span> claude

<span class="terminal-comment"># Ele pode ler, escrever, executar comandos</span>
<span class="terminal-comment"># Criar ferramentas, iterar, corrigir erros</span>
<span class="terminal-comment"># Trabalhar em paralelo com subagentes</span>
                </code></pre>
            \`,
            exercise: {
                title: "Reflexao Guiada",
                icon: "ğŸ¯",
                description: "Antes de comecar a jornada tecnica, faca uma auto-avaliacao honesta sobre seu uso atual de IA.",
                steps: [
                    {
                        title: "Liste suas frustraÃ§Ãµes",
                        items: [
                            "Pense nas ultimas 5 vezes que usou ChatGPT ou Claude Web",
                            "Anote o que funcionou bem",
                            "Anote o que te frustrou ou limitou"
                        ]
                    },
                    {
                        title: "Identifique padrÃµes",
                        items: [
                            "Quantas vezes voce precisou copiar/colar entre janelas?",
                            "Quantas vezes a conversa ficou longa demais e perdeu o contexto?",
                            "Quantas vezes voce desejou que o assistente fizesse mais sozinho?"
                        ]
                    },
                    {
                        title: "Tome a decisao",
                        items: [
                            "Voce esta disposto a sair da zona de conforto?",
                            "Aceita aprender a usar o terminal?",
                            "Aceita o chamado a aventura?"
                        ]
                    }
                ],
                checklist: [
                    "Listei pelo menos 3 frustracoes com o modo assistente",
                    "Identifiquei situacoes onde fui o 'middleware'",
                    "Decidi conscientemente continuar o curso"
                ]
            },
            tip: "Esta aula e de sensibilizacao. Nao se preocupe em entender tudo tecnicamente ainda. O objetivo e plantar a semente da mudanca.",
            warning: "Nao pule esta reflexao. Quem entra no mundo agentico sem entender POR QUE esta mudando, tende a voltar para a zona de conforto na primeira dificuldade."
        },

        "1": {
            number: "1",
            module: "Modulo 1 - Fundamentos",
            title: "A Era dos Agentes",
            objective: "Demonstrar na pratica as capacidades e limitacoes do modo agentico no Claude Web/Desktop e visualizar o resultado final (CLERK) que sera construido.",
            learningObjectives: [
                "Usar <strong>Artifacts no Claude Web</strong> para gerar documentos juridicos",
                "Configurar <strong>Projects</strong> com instrucoes persistentes",
                "Identificar <strong>limitacoes praticas</strong> do modo web",
                "Visualizar o <strong>pipeline CLERK</strong> como motivacao"
            ],
            whyItMatters: "Antes de mergulhar no terminal, e importante conhecer o que ja existe no modo web. Isso estabelece a baseline e mostra claramente o que falta para trabalho profissional em escala.",
            content: \`
                <h3>O Claude Web em Modo Agentico</h3>
                <p>O Claude Web/Desktop ja oferece capacidades agenticas:</p>
                <ul>
                    <li><strong>Artifacts:</strong> Documentos gerados que podem ser editados e baixados</li>
                    <li><strong>Projects:</strong> Instrucoes persistentes (como um CLAUDE.md do web)</li>
                    <li><strong>MCPs Pre-configurados:</strong> Integracao com Drive, Notion, GitHub</li>
                    <li><strong>Ferramentas:</strong> Busca na web, analise de imagens, execucao de codigo</li>
                </ul>

                <h3>Demonstracao: Artifact Juridico</h3>
                <p>Veja como gerar uma minuta no Claude Web:</p>
                <pre><code>
Prompt:
"Elabore uma minuta de despacho saneador para uma acao
de indenizacao por danos morais, fixando os pontos
controvertidos e deferindo provas."

O Claude gera um Artifact editavel que pode ser
copiado ou baixado como documento.
                </code></pre>

                <h3>As Limitacoes na Pratica</h3>
                <p>Tente fazer um pipeline completo no web:</p>
                <ol>
                    <li>Baixar processo do PJe âŒ (nao tem acesso)</li>
                    <li>Converter PDF para texto âŒ (limitado)</li>
                    <li>Analisar 500 paginas âŒ (limite de contexto)</li>
                    <li>Pesquisar precedentes em 3 bases âŒ (nao tem MCPs)</li>
                    <li>Gerar relatorio estruturado âš ï¸ (parcial)</li>
                    <li>Minutar sentenca âš ï¸ (sem contexto completo)</li>
                </ol>

                <h3>O Resultado Final: CLERK</h3>
                <p>No Claude Code, o pipeline completo funciona:</p>
                <pre><code class="terminal">
<span class="terminal-prompt">$</span> /baixar-pje 0000123-45.2024.4.05.8100
<span class="terminal-comment"># Baixa todos os documentos do processo</span>

<span class="terminal-prompt">$</span> /converter-pdf
<span class="terminal-comment"># Converte PDFs para texto com OCR</span>

<span class="terminal-prompt">$</span> /relatar-processo
<span class="terminal-comment"># Gera relatorio estruturado Marmelstein</span>

<span class="terminal-prompt">$</span> /pipeline-pesquisa
<span class="terminal-comment"># Pesquisa em BNP, JULIA e CJF em paralelo</span>

<span class="terminal-prompt">$</span> /minutar-sentenca
<span class="terminal-comment"># Gera minuta com fundamentacao completa</span>
                </code></pre>
            \`,
            exercise: {
                title: "Explorando o Claude Web",
                icon: "ğŸ”¬",
                description: "Experimente as capacidades agenticas do Claude Web para estabelecer sua baseline.",
                steps: [
                    {
                        title: "Crie um Artifact",
                        items: [
                            "Acesse claude.ai",
                            "Peca: 'Crie uma minuta de despacho saneador'",
                            "Observe o Artifact gerado a direita",
                            "Tente editar e baixar o documento"
                        ]
                    },
                    {
                        title: "Configure um Project",
                        items: [
                            "Va em Projects (menu lateral)",
                            "Crie um projeto 'Analise Juridica'",
                            "Adicione instrucoes: 'Voce e um analista juridico especializado em direito civil'",
                            "Teste se as instrucoes persistem entre conversas"
                        ]
                    },
                    {
                        title: "Encontre as limitacoes",
                        items: [
                            "Tente anexar um PDF de 100+ paginas",
                            "Peca para salvar um arquivo no seu computador",
                            "Tente executar um comando no terminal",
                            "Anote o que NAO funcionou"
                        ]
                    }
                ],
                checklist: [
                    "Criei pelo menos um Artifact editavel",
                    "Configurei um Project com instrucoes",
                    "Identifiquei pelo menos 3 limitacoes do modo web",
                    "Entendi por que o terminal e necessario"
                ]
            },
            tip: "O Claude Web e excelente para tarefas pontuais. Nao o descarte. Use-o quando fizer sentido. O terminal e para quando voce precisa de mais.",
            warning: "Nao tente fazer trabalho profissional em escala no modo web. As limitacoes vao te frustrar. Guarde a energia para aprender o Claude Code."
        },

        "2": {
            number: "2",
            module: "Modulo 1 - Fundamentos",
            title: "Desvendando o Claude Code",
            objective: "Instalar, configurar e dominar a interface basica do Claude Code, executando seus primeiros comandos no terminal.",
            learningObjectives: [
                "Instalar o <strong>Claude Code</strong> no seu sistema",
                "Entender a <strong>anatomia da interface</strong> do terminal",
                "Executar os <strong>primeiros comandos</strong> (help, status, cost)",
                "Configurar o <strong>CLAUDE.md</strong> do projeto"
            ],
            whyItMatters: "O terminal e onde a magia acontece. Dominar a interface basica e o primeiro passo para desbloquear todo o potencial do modo agentico.",
            content: \`
                <h3>O que e Claude Code</h3>
                <p>Claude Code e uma CLI (Command Line Interface) que permite ao Claude:</p>
                <ul>
                    <li>Acessar seu sistema de arquivos</li>
                    <li>Executar comandos no terminal</li>
                    <li>Criar e modificar codigo</li>
                    <li>Usar ferramentas externas (MCPs)</li>
                    <li>Trabalhar com subagentes em paralelo</li>
                </ul>

                <h3>Instalacao</h3>
                <pre><code class="terminal">
<span class="terminal-comment"># Opcao 1: npm (recomendado)</span>
<span class="terminal-prompt">$</span> npm install -g @anthropic-ai/claude-code

<span class="terminal-comment"># Opcao 2: Homebrew (Mac)</span>
<span class="terminal-prompt">$</span> brew install claude-code

<span class="terminal-comment"># Verificar instalacao</span>
<span class="terminal-prompt">$</span> claude --version
                </code></pre>

                <h3>Primeiros Comandos</h3>
                <pre><code class="terminal">
<span class="terminal-comment"># Iniciar o Claude Code</span>
<span class="terminal-prompt">$</span> claude

<span class="terminal-comment"># Ver ajuda</span>
<span class="terminal-prompt">></span> /help

<span class="terminal-comment"># Ver status da sessao</span>
<span class="terminal-prompt">></span> /status

<span class="terminal-comment"># Ver custo da sessao</span>
<span class="terminal-prompt">></span> /cost

<span class="terminal-comment"># Limpar conversa</span>
<span class="terminal-prompt">></span> /clear
                </code></pre>

                <h3>O Arquivo CLAUDE.md</h3>
                <p>O CLAUDE.md e o "cerebro" do projeto. Instrucoes que o Claude le automaticamente:</p>
                <pre><code>
# CLAUDE.md

## Projeto
Analise de processos judiciais.

## Convencoes
- Usar portugues brasileiro
- Citar jurisprudencia no formato ABNT
- Sempre verificar precedentes vinculantes

## Comandos Disponiveis
- /relatar: Gera relatorio do processo
- /analisar: Analise juridica completa
                </code></pre>
            \`,
            exercise: {
                title: "Instalacao e Primeiros Passos",
                icon: "âš¡",
                description: "Instale o Claude Code e execute seus primeiros comandos.",
                steps: [
                    {
                        title: "Instale o Claude Code",
                        items: [
                            "Abra o terminal (CMD, PowerShell ou Terminal)",
                            "Execute: npm install -g @anthropic-ai/claude-code",
                            "Aguarde a instalacao completar",
                            "Verifique: claude --version"
                        ]
                    },
                    {
                        title: "Inicie sua primeira sessao",
                        items: [
                            "Navegue para uma pasta de teste: cd ~/teste-claude",
                            "Crie a pasta se nao existir: mkdir teste-claude",
                            "Inicie o Claude: claude",
                            "Execute /help e leia as opcoes"
                        ]
                    },
                    {
                        title: "Crie seu primeiro CLAUDE.md",
                        items: [
                            "Peca ao Claude: 'Crie um CLAUDE.md basico para analise juridica'",
                            "Observe o arquivo sendo criado",
                            "Leia o conteudo gerado",
                            "Feche e reabra o Claude para ver as instrucoes carregadas"
                        ]
                    }
                ],
                checklist: [
                    "Claude Code instalado e funcionando",
                    "Executei /help, /status e /cost",
                    "Criei um CLAUDE.md basico",
                    "Verifiquei que as instrucoes sao carregadas automaticamente"
                ]
            },
            tip: "Comece em uma pasta vazia de teste. Assim voce pode experimentar sem medo de baguncar projetos existentes.",
            warning: "Se a instalacao falhar, verifique se Node.js esta instalado (node --version). O Claude Code requer Node.js 18+."
        },

        "3": {
            number: "3",
            module: "Modulo 1 - Fundamentos",
            title: "Arquitetura de Agentes",
            objective: "Dominar os padroes arquiteturais de sistemas agenticos: pipelines, workflows, gates, routers e subagentes.",
            learningObjectives: [
                "Distinguir <strong>Pipeline vs Workflow vs Agent Loop</strong>",
                "Entender <strong>Gates</strong> (validacao e controle de qualidade)",
                "Usar <strong>Routers</strong> para decisao condicional",
                "Aplicar <strong>subagentes</strong> para especializacao"
            ],
            whyItMatters: "Antes de construir agentes, voce precisa entender os padroes. Assim como um arquiteto conhece fundacoes antes de projetar casas, voce precisa conhecer pipelines antes de construir sistemas.",
            content: \`
                <h3>Os Tres Paradigmas</h3>
                <p>Existem tres formas de organizar fluxos agenticos:</p>

                <h4>1. Pipeline (Sequencial)</h4>
                <pre><code>
Input â†’ Etapa 1 â†’ Etapa 2 â†’ Etapa 3 â†’ Output

Exemplo juridico:
PDF â†’ Converter â†’ Relatar â†’ Analisar â†’ Minutar
                </code></pre>
                <p>Cada etapa depende da anterior. Simples e previsivel.</p>

                <h4>2. Workflow (Condicional)</h4>
                <pre><code>
            â”Œâ†’ Rota A â†’â”
Input â†’ Router        â†’ Output
            â””â†’ Rota B â†’â”˜

Exemplo:
Processo â†’ [Criminal?] â†’ Sim â†’ Fluxo Penal
                       â†’ Nao â†’ Fluxo Civel
                </code></pre>
                <p>Decisoes determinam o caminho. Mais flexivel.</p>

                <h4>3. Agent Loop (Autonomo)</h4>
                <pre><code>
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚
Input â†’ â”‚  Pensar â†’ Agir â†’ ? â”‚ â†’ Output
        â”‚     â†‘         â”‚    â”‚
        â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

O agente decide sozinho quando parar.
                </code></pre>
                <p>Autonomia maxima. Mais poderoso, mas menos previsivel.</p>

                <h3>Componentes Essenciais</h3>
                <h4>Gates (Portoes de Qualidade)</h4>
                <pre><code>
Etapa 1 â†’ [GATE: Validar] â†’ Etapa 2
              â†“
          [Falhou] â†’ Retrabalho

"Nunca siga em frente sem validar a etapa anterior."
                </code></pre>

                <h4>Routers (Decisores)</h4>
                <pre><code>
Input â†’ [Router: Classificar]
            â”‚
        â”Œâ”€â”€â”€â”¼â”€â”€â”€â”
        â†“   â†“   â†“
      Civil Penal Trabalhista
                </code></pre>

                <h4>Subagentes (Especializacao)</h4>
                <pre><code>
Orquestrador
    â”‚
    â”œâ”€â”€ Subagente: Pesquisa BNP
    â”œâ”€â”€ Subagente: Pesquisa JULIA
    â””â”€â”€ Subagente: Pesquisa CJF

Trabalham em PARALELO, cada um especializado.
                </code></pre>
            \`,
            exercise: {
                title: "Desenhando Arquiteturas",
                icon: "ğŸ“",
                description: "Pratique desenhando arquiteturas de sistemas agenticos para casos juridicos reais.",
                steps: [
                    {
                        title: "Desenhe um Pipeline",
                        items: [
                            "Pegue papel ou abra um editor de texto",
                            "Desenhe o fluxo: Processo â†’ Relatorio â†’ Analise â†’ Minuta",
                            "Identifique onde colocar Gates de validacao",
                            "Anote o que cada etapa precisa como input/output"
                        ]
                    },
                    {
                        title: "Adicione um Router",
                        items: [
                            "Pense: e se o processo for criminal vs civel?",
                            "Desenhe um Router apos a etapa de Relatorio",
                            "Crie duas rotas diferentes para cada tipo",
                            "Identifique o que muda em cada rota"
                        ]
                    },
                    {
                        title: "Projete Subagentes",
                        items: [
                            "Imagine a etapa de pesquisa de precedentes",
                            "Desenhe 3 subagentes paralelos (BNP, JULIA, CJF)",
                            "Adicione um consolidador que une os resultados",
                            "Pense: como lidar se um subagente falhar?"
                        ]
                    }
                ],
                checklist: [
                    "Desenhei um pipeline sequencial completo",
                    "Adicionei Gates de validacao em pontos criticos",
                    "Criei um Router com pelo menos 2 rotas",
                    "Projetei subagentes paralelos com consolidacao"
                ]
            },
            tip: "Comece sempre pelo pipeline mais simples. Adicione complexidade (routers, subagentes) apenas quando necessario.",
            warning: "Nao caia na tentacao de criar arquiteturas complexas demais. 'Keep it simple' e uma regra de ouro em sistemas agenticos."
        },

        "3.5": {
            number: "3.5",
            module: "Modulo 1 - Fundamentos",
            title: "Agent Teams",
            objective: "Dominar a orquestracao de multiplos agentes trabalhando em equipe para resolver problemas complexos.",
            learningObjectives: [
                "Entender o conceito de <strong>Agent Teams</strong> (times de agentes)",
                "Diferenciar <strong>orquestracao vs colaboracao</strong>",
                "Configurar <strong>comunicacao entre agentes</strong>",
                "Aplicar <strong>padroes de coordenacao</strong>"
            ],
            whyItMatters: "Problemas complexos requerem especializacao. Um time de agentes especializados e mais eficiente que um agente generalista tentando fazer tudo.",
            content: \`
                <h3>O que sao Agent Teams?</h3>
                <p>Agent Teams sao grupos de agentes especializados que trabalham juntos:</p>
                <ul>
                    <li><strong>Orquestrador:</strong> Coordena o time, distribui tarefas</li>
                    <li><strong>Especialistas:</strong> Agentes focados em uma competencia</li>
                    <li><strong>Consolidador:</strong> Une os resultados dos especialistas</li>
                </ul>

                <h3>Padroes de Coordenacao</h3>
                <h4>1. Hub-and-Spoke (Orquestrador Central)</h4>
                <pre><code>
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Orquestrador    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”Œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”
          â†“     â†“     â†“
       Agent  Agent  Agent
         A      B      C
                </code></pre>
                <p>Um lider distribui tarefas. Simples e previsivel.</p>

                <h4>2. Pipeline com Handoff</h4>
                <pre><code>
Agent A â†’ Agent B â†’ Agent C â†’ Output
  â†“          â†“          â†“
 (etapa 1) (etapa 2) (etapa 3)
                </code></pre>
                <p>Cada agente completa sua parte e passa adiante.</p>

                <h4>3. Parallel-then-Merge</h4>
                <pre><code>
            â”Œâ†’ Agent A â†’â”
Input â†’ Split          Merge â†’ Output
            â””â†’ Agent B â†’â”˜
                </code></pre>
                <p>Trabalho paralelo, depois consolidacao.</p>

                <h3>Exemplo: Pipeline de Pesquisa</h3>
                <pre><code class="terminal">
<span class="terminal-comment"># Orquestrador dispara 3 subagentes em paralelo</span>

Subagente BNP:  Pesquisando precedentes STF/STJ...
Subagente JULIA: Pesquisando jurisprudencia TRF5...
Subagente CJF:  Pesquisando todos os TRFs...

<span class="terminal-comment"># Consolidador une os resultados</span>

Consolidador: 47 precedentes encontrados
             - 12 STF/STJ (BNP)
             - 23 TRF5 (JULIA)
             - 12 outros TRFs (CJF)
                </code></pre>
            \`,
            exercise: {
                title: "Projetando um Time",
                icon: "ğŸ‘¥",
                description: "Projete um time de agentes para um caso juridico real.",
                steps: [
                    {
                        title: "Defina o problema",
                        items: [
                            "Escolha um tipo de processo (ex: previdenciario)",
                            "Liste todas as tarefas necessarias para analise completa",
                            "Identifique quais tarefas podem ser paralelizadas",
                            "Identifique dependencias entre tarefas"
                        ]
                    },
                    {
                        title: "Projete os agentes",
                        items: [
                            "Crie um Orquestrador com visao geral",
                            "Defina 3-5 agentes especialistas",
                            "Especifique o que cada um recebe e entrega",
                            "Defina o Consolidador final"
                        ]
                    },
                    {
                        title: "Simule a execucao",
                        items: [
                            "Trace o fluxo de informacao entre agentes",
                            "Identifique possiveis gargalos",
                            "Pense: o que acontece se um agente falhar?",
                            "Adicione fallbacks se necessario"
                        ]
                    }
                ],
                checklist: [
                    "Defini claramente o problema a resolver",
                    "Criei um Orquestrador com responsabilidades claras",
                    "Projetei pelo menos 3 agentes especialistas",
                    "Defini comunicacao e fallbacks entre agentes"
                ]
            },
            tip: "Cada agente deve ter uma responsabilidade unica e bem definida. Se um agente faz 'de tudo um pouco', divida-o.",
            warning: "Times muito grandes sao dificeis de coordenar. Comece com 3-5 agentes. Adicione mais apenas se necessario."
        },

        "4": {
            number: "4",
            module: "Modulo 1 - Fundamentos",
            title: "Construindo os Primeiros Agentes",
            objective: "Criar seus primeiros agentes usando Skills e Commands do Claude Code.",
            learningObjectives: [
                "Entender a diferenca entre <strong>Skills e Commands</strong>",
                "Criar um <strong>Command simples</strong>",
                "Desenvolver uma <strong>Skill basica</strong>",
                "Usar o <strong>ciclo de debug</strong> para iterar"
            ],
            whyItMatters: "Agora que voce entende a teoria, e hora de colocar a mao na massa. Criar seus proprios agentes e o que diferencia usuarios de construtores.",
            content: \`
                <h3>Skills vs Commands</h3>
                <table>
                    <tr>
                        <th>Aspecto</th>
                        <th>Skill</th>
                        <th>Command</th>
                    </tr>
                    <tr>
                        <td>Ativacao</td>
                        <td>Automatica (Claude decide)</td>
                        <td>Manual (/comando)</td>
                    </tr>
                    <tr>
                        <td>Escopo</td>
                        <td>Comportamento geral</td>
                        <td>Tarefa especifica</td>
                    </tr>
                    <tr>
                        <td>Exemplo</td>
                        <td>"Sempre citar fontes"</td>
                        <td>"/relatar processo"</td>
                    </tr>
                </table>

                <h3>Anatomia de um Command</h3>
                <pre><code>
# .claude/commands/relatar.md

---
name: relatar
description: Gera relatorio estruturado do processo
arguments:
  - name: numero
    description: Numero do processo
    required: true
---

# Comando: Relatar Processo

Ao receber este comando:
1. Leia todos os documentos da pasta do processo
2. Extraia fatos relevantes em ordem cronologica
3. Identifique partes, pedidos e pontos controvertidos
4. Gere relatorio no formato Marmelstein
                </code></pre>

                <h3>Anatomia de uma Skill</h3>
                <pre><code>
# .claude/skills/citacao-juridica.md

---
name: citacao-juridica
description: Padroniza citacoes juridicas
trigger: quando gerar documentos juridicos
---

# Skill: Citacao Juridica

## Comportamento
Ao gerar qualquer documento juridico:
- Cite jurisprudencia no formato: Tribunal, Tipo Numero, Relator, Data
- Cite legislacao no formato: Lei X.XXX/AAAA, art. Y
- Sempre inclua link para inteiro teor quando disponivel

## Exemplos
STF, RE 123456, Rel. Min. Fulano, j. 01/01/2024
Lei 8.112/1990, art. 132, IV
                </code></pre>

                <h3>Ciclo de Debug</h3>
                <pre><code class="terminal">
<span class="terminal-comment"># 1. Crie a versao inicial</span>
<span class="terminal-prompt">$</span> cat > .claude/commands/meu-comando.md

<span class="terminal-comment"># 2. Teste</span>
<span class="terminal-prompt">></span> /meu-comando argumento

<span class="terminal-comment"># 3. Observe o resultado</span>
<span class="terminal-comment"># 4. Identifique o que faltou</span>
<span class="terminal-comment"># 5. Edite o comando</span>
<span class="terminal-comment"># 6. Repita ate funcionar</span>
                </code></pre>
            \`,
            exercise: {
                title: "Crie Seu Primeiro Command",
                icon: "ğŸ”§",
                description: "Construa um command simples para gerar relatorios de processos.",
                steps: [
                    {
                        title: "Crie a estrutura",
                        items: [
                            "Navegue para seu projeto de teste",
                            "Crie a pasta: mkdir -p .claude/commands",
                            "Crie o arquivo: touch .claude/commands/resumir.md",
                            "Abra no editor de sua preferencia"
                        ]
                    },
                    {
                        title: "Escreva o command",
                        items: [
                            "Adicione o frontmatter (name, description)",
                            "Descreva o que o command deve fazer",
                            "Especifique o formato de saida esperado",
                            "Adicione exemplos se possivel"
                        ]
                    },
                    {
                        title: "Teste e itere",
                        items: [
                            "Inicie o Claude: claude",
                            "Execute: /resumir [texto de teste]",
                            "Avalie o resultado",
                            "Ajuste o command e repita"
                        ]
                    }
                ],
                checklist: [
                    "Criei a pasta .claude/commands/",
                    "Escrevi um command com frontmatter correto",
                    "Testei o command pelo menos 3 vezes",
                    "Iterai ate obter resultado satisfatorio"
                ]
            },
            tip: "Comece com commands simples e especificos. E mais facil depurar 'resumir texto' do que 'analisar processo inteiro'.",
            warning: "Nao tente criar commands perfeitos na primeira tentativa. O ciclo 'criar â†’ testar â†’ ajustar' e normal e esperado."
        },

        "4.5": {
            number: "4.5",
            module: "Modulo 1 - Fundamentos",
            title: "Hooks - Automacao Deterministica",
            objective: "Usar Hooks para automatizar acoes determinadas em resposta a eventos do Claude Code.",
            learningObjectives: [
                "Entender o conceito de <strong>Hooks</strong> (gatilhos automaticos)",
                "Diferenciar <strong>Hooks de Skills</strong>",
                "Configurar <strong>pre-commit hooks</strong>",
                "Criar <strong>automacoes baseadas em eventos</strong>"
            ],
            whyItMatters: "Hooks permitem automacoes deterministicas - acoes que SEMPRE acontecem quando um evento ocorre. Isso libera o Claude para decisoes mais complexas.",
            content: \`
                <h3>O que sao Hooks?</h3>
                <p>Hooks sao scripts que executam automaticamente em resposta a eventos:</p>
                <ul>
                    <li><strong>pre-commit:</strong> Antes de salvar alteracoes</li>
                    <li><strong>post-create:</strong> Apos criar arquivos</li>
                    <li><strong>on-error:</strong> Quando ocorre um erro</li>
                    <li><strong>session-start:</strong> Ao iniciar sessao</li>
                </ul>

                <h3>Hooks vs Skills</h3>
                <table>
                    <tr>
                        <th>Aspecto</th>
                        <th>Hook</th>
                        <th>Skill</th>
                    </tr>
                    <tr>
                        <td>Execucao</td>
                        <td>Deterministica (sempre)</td>
                        <td>Probabilistica (Claude decide)</td>
                    </tr>
                    <tr>
                        <td>Gatilho</td>
                        <td>Evento do sistema</td>
                        <td>Contexto da conversa</td>
                    </tr>
                    <tr>
                        <td>Linguagem</td>
                        <td>Shell script, Python, etc.</td>
                        <td>Prompt em linguagem natural</td>
                    </tr>
                </table>

                <h3>Exemplo: Hook de Validacao</h3>
                <pre><code>
# .claude/hooks/pre-commit.sh

#!/bin/bash
# Valida documentos juridicos antes de salvar

FILE="$1"

# Verifica se tem citacao sem fonte
if grep -q "conforme jurisprudencia" "$FILE"; then
    if ! grep -q "STF\\|STJ\\|TRF" "$FILE"; then
        echo "ERRO: Citacao sem fonte especifica"
        exit 1
    fi
fi

echo "Validacao OK"
exit 0
                </code></pre>

                <h3>Configurando Hooks</h3>
                <pre><code class="terminal">
<span class="terminal-comment"># Criar pasta de hooks</span>
<span class="terminal-prompt">$</span> mkdir -p .claude/hooks

<span class="terminal-comment"># Criar hook de validacao</span>
<span class="terminal-prompt">$</span> cat > .claude/hooks/pre-commit.sh << 'EOF'
#!/bin/bash
echo "Validando arquivo: $1"
# Adicione suas validacoes aqui
EOF

<span class="terminal-comment"># Tornar executavel</span>
<span class="terminal-prompt">$</span> chmod +x .claude/hooks/pre-commit.sh
                </code></pre>
            \`,
            exercise: {
                title: "Crie Seu Primeiro Hook",
                icon: "ğŸª",
                description: "Implemente um hook de validacao para documentos juridicos.",
                steps: [
                    {
                        title: "Crie a estrutura",
                        items: [
                            "Navegue para seu projeto",
                            "Crie a pasta: mkdir -p .claude/hooks",
                            "Crie o arquivo: touch .claude/hooks/pre-commit.sh",
                            "Torne executavel: chmod +x .claude/hooks/pre-commit.sh"
                        ]
                    },
                    {
                        title: "Implemente validacoes",
                        items: [
                            "Verifique se documentos tem data",
                            "Verifique se citacoes tem fontes",
                            "Verifique se nao ha placeholders ([COMPLETAR])",
                            "Retorne exit 1 se houver erro"
                        ]
                    },
                    {
                        title: "Teste o hook",
                        items: [
                            "Crie um documento com erro proposital",
                            "Peca ao Claude para salvar",
                            "Verifique se o hook bloqueou",
                            "Corrija o documento e tente novamente"
                        ]
                    }
                ],
                checklist: [
                    "Criei a pasta .claude/hooks/",
                    "Implementei pelo menos 2 validacoes",
                    "Testei o hook com documento invalido",
                    "Verifiquei que documentos validos passam"
                ]
            },
            tip: "Hooks sao otimos para validacoes simples e repetitivas. Deixe decisoes complexas para Skills.",
            warning: "Hooks bloqueantes (que retornam exit 1) podem frustrar o fluxo. Use com moderacao."
        },

        "5": {
            number: "5",
            module: "Modulo 1 - Fundamentos",
            title: "Sistema Juridico Agentico",
            objective: "Construir o pipeline CLERK completo: baixar, converter, relatar, analisar e minutar processos judiciais.",
            learningObjectives: [
                "Integrar <strong>MCPs de precedentes</strong> (BNP, JULIA, CJF)",
                "Configurar <strong>integracao com PJe</strong>",
                "Construir o <strong>pipeline completo</strong> de analise",
                "Executar <strong>revisao com subagentes paralelos</strong>"
            ],
            whyItMatters: "Este e o objetivo final do modulo: um sistema completo que automatiza o trabalho juridico repetitivo, liberando voce para o que realmente importa - pensar e decidir.",
            content: \`
                <h3>O Sistema CLERK</h3>
                <p>CLERK (Claude Legal Expert Reasoning Kit) e um pipeline completo:</p>
                <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PIPELINE CLERK                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  /baixar-pje â”€â”€â–¶ /converter-pdf â”€â”€â–¶ /relatar-processo      â”‚
â”‚       â”‚                â”‚                    â”‚               â”‚
â”‚       â–¼                â–¼                    â–¼               â”‚
â”‚   Documentos        Textos              Relatorio           â”‚
â”‚   do PJe            limpos              estruturado         â”‚
â”‚                                                             â”‚
â”‚  /pipeline-pesquisa â”€â”€â–¶ /analisar â”€â”€â–¶ /minutar-sentenca    â”‚
â”‚       â”‚                    â”‚               â”‚                â”‚
â”‚       â–¼                    â–¼               â–¼                â”‚
â”‚   Precedentes          Analise          Minuta              â”‚
â”‚   consolidados         juridica         completa            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </code></pre>

                <h3>MCPs Juridicos</h3>
                <p>Model Context Protocol (MCP) permite ao Claude acessar fontes externas:</p>
                <ul>
                    <li><strong>BNP:</strong> Banco Nacional de Precedentes (STF/STJ)</li>
                    <li><strong>JULIA:</strong> Jurisprudencia do TRF5</li>
                    <li><strong>CJF:</strong> Portal de jurisprudencia unificada</li>
                </ul>

                <h3>Pipeline de Pesquisa Paralela</h3>
                <pre><code class="terminal">
<span class="terminal-prompt">></span> /pipeline-pesquisa "auxilio-doenca negado"

<span class="terminal-comment"># 3 subagentes disparam em paralelo:</span>

[BNP]   Buscando precedentes vinculantes...
[JULIA] Buscando jurisprudencia TRF5...
[CJF]   Buscando todos os TRFs...

<span class="terminal-comment"># Consolidador une resultados:</span>

[CONSOLIDADO] 47 precedentes encontrados
- Tema 1066 STJ: Auxilio-doenca e qualidade de segurado
- Tema 177 TRF5: Incapacidade parcial e BPC
- 12 acordaos relevantes do TRF1, TRF2, TRF4
                </code></pre>

                <h3>Revisao Multi-Agente</h3>
                <pre><code>
Minuta gerada â†’ Revisores paralelos:
    â”‚
    â”œâ”€â”€ Verificador de Fontes
    â”œâ”€â”€ Verificador de Calculos
    â”œâ”€â”€ Verificador de Honorarios
    â””â”€â”€ Verificador de Remessa

    â†’ Consolidador de Revisao â†’ Minuta Robustecida
                </code></pre>
            \`,
            exercise: {
                title: "Pipeline Completo",
                icon: "ğŸ—ï¸",
                description: "Execute o pipeline CLERK completo em um processo de exemplo.",
                steps: [
                    {
                        title: "Prepare o ambiente",
                        items: [
                            "Verifique que os MCPs estao configurados",
                            "Tenha um numero de processo de teste",
                            "Crie uma pasta para o projeto",
                            "Inicie o Claude com: claude"
                        ]
                    },
                    {
                        title: "Execute o pipeline",
                        items: [
                            "Baixe: /baixar-pje [numero]",
                            "Converta: /converter-pdf",
                            "Relate: /relatar-processo",
                            "Pesquise: /pipeline-pesquisa [tema]"
                        ]
                    },
                    {
                        title: "Gere a minuta",
                        items: [
                            "Analise: /analisar-processo",
                            "Minute: /minutar-sentenca",
                            "Revise: /pipeline-revisao",
                            "Exporte o resultado final"
                        ]
                    }
                ],
                checklist: [
                    "Baixei documentos do PJe com sucesso",
                    "Converti PDFs para texto legivel",
                    "Gerei relatorio estruturado",
                    "Pesquisei precedentes em multiplas fontes",
                    "Gerei minuta com fundamentacao completa"
                ]
            },
            tip: "O pipeline completo pode demorar alguns minutos. Use esse tempo para revisar os resultados intermediarios.",
            warning: "Nunca publique uma minuta sem revisao humana. O sistema e um assistente, nao um substituto do juiz."
        }
    };

    // ===== LESSON ORDER =====
    const lessonOrder = ["0", "1", "2", "3", "3.5", "4", "4.5", "5"];

    // ===== STATE =====
    let currentLesson = "0";

    // ===== INITIALIZATION =====
    document.addEventListener('DOMContentLoaded', () => {
        initializeApp();
    });

    function initializeApp() {
        renderNavigation();
        loadLesson(currentLesson);
        setupEventListeners();
        loadTheme();
        registerServiceWorker();
    }

    // ===== NAVIGATION =====
    function renderNavigation() {
        const nav = document.getElementById('sidebar-nav');
        let currentModule = '';
        let html = '';

        lessonOrder.forEach(key => {
            const lesson = lessons[key];
            if (!lesson) return;

            // Check if we need a new module section
            if (lesson.module !== currentModule) {
                if (currentModule !== '') {
                    html += '</div>';
                }
                currentModule = lesson.module;
                html += \`
                    <div class="nav-section">
                        <div class="nav-section-title">\${lesson.module}</div>
                \`;
            }

            html += \`
                <div class="nav-item" data-lesson="\${key}" onclick="loadLesson('\${key}')">
                    <span class="nav-item-number">\${lesson.number}</span>
                    <span class="nav-item-title">\${lesson.title}</span>
                </div>
            \`;
        });

        html += '</div>';
        nav.innerHTML = html;
    }

    function loadLesson(lessonKey) {
        const lesson = lessons[lessonKey];
        if (!lesson) return;

        currentLesson = lessonKey;
        updateActiveNav(lessonKey);
        renderLesson(lesson);
        window.scrollTo(0, 0);
    }

    function updateActiveNav(lessonKey) {
        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active');
            if (item.dataset.lesson === lessonKey) {
                item.classList.add('active');
            }
        });
    }

    // ===== LESSON RENDERING =====
    function renderLesson(lesson) {
        const main = document.getElementById('main-content');

        const learningObjectivesHtml = lesson.learningObjectives ?
            lesson.learningObjectives.map(obj => \`<li>\${obj}</li>\`).join('') : '';

        const stepsHtml = lesson.exercise.steps ?
            lesson.exercise.steps.map((step, i) => \`
                <div class="exercise-step">
                    <div class="exercise-step-header">
                        <span class="exercise-step-number">\${i + 1}</span>
                        <span class="exercise-step-title">\${step.title}</span>
                    </div>
                    <div class="exercise-step-content">
                        <ul>
                            \${step.items.map(item => \`<li>\${item}</li>\`).join('')}
                        </ul>
                    </div>
                </div>
            \`).join('') : '';

        const checklistHtml = lesson.exercise.checklist ?
            lesson.exercise.checklist.map((item, i) => \`
                <label class="exercise-checklist-item">
                    <input type="checkbox" id="check-\${i}">
                    <span class="exercise-checklist-box"></span>
                    <span class="exercise-checklist-label">\${item}</span>
                </label>
            \`).join('') : '';

        main.innerHTML = \`
            <!-- Header -->
            <div class="lesson-header-compact">
                <div class="lesson-breadcrumb">
                    <span class="lesson-badge">\${lesson.number}</span>
                    <span class="lesson-module-name">\${lesson.module}</span>
                </div>
                <h1 class="lesson-title-v3">\${lesson.title}</h1>
                <p class="lesson-objective-v3">\${lesson.objective}</p>
            </div>

            <!-- Learning Objectives -->
            <div class="learning-objectives-card">
                <div class="learning-objectives-header">
                    <span class="learning-objectives-icon">ğŸ¯</span>
                    <span class="learning-objectives-title">Objetivos de Aprendizagem</span>
                </div>
                <ul class="learning-objectives-list">
                    \${learningObjectivesHtml}
                </ul>
                <div class="why-it-matters">
                    <strong>Por que importa:</strong> \${lesson.whyItMatters}
                </div>
            </div>

            <!-- Exercise Card -->
            <div class="exercise-card-v3">
                <div class="exercise-card-header">
                    <span class="exercise-card-icon">\${lesson.exercise.icon}</span>
                    <div class="exercise-card-meta">
                        <span class="exercise-card-label">Exercicio Pratico</span>
                        <h2 class="exercise-card-title">\${lesson.exercise.title}</h2>
                    </div>
                </div>
                <div class="exercise-card-body">
                    <p class="exercise-description">\${lesson.exercise.description}</p>

                    <div class="exercise-steps-container">
                        <div class="exercise-steps-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
                            </svg>
                            Passo a Passo
                        </div>
                        \${stepsHtml}
                    </div>

                    <div class="exercise-checklist-container">
                        <div class="exercise-checklist-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                <polyline points="22 4 12 14.01 9 11.01"/>
                            </svg>
                            Checklist de Verificacao
                        </div>
                        <div class="exercise-checklist-items">
                            \${checklistHtml}
                        </div>
                    </div>

                    \${lesson.tip ? \`
                        <div class="exercise-tip">
                            <span class="exercise-tip-icon">ğŸ’¡</span>
                            <div class="exercise-tip-content">
                                <strong>Dica:</strong> \${lesson.tip}
                            </div>
                        </div>
                    \` : ''}

                    \${lesson.warning ? \`
                        <div class="exercise-warning">
                            <span class="exercise-warning-icon">âš ï¸</span>
                            <div class="exercise-warning-content">
                                <strong>Atencao:</strong> \${lesson.warning}
                            </div>
                        </div>
                    \` : ''}
                </div>
            </div>

            <!-- Theory Section (Collapsible) -->
            <div class="theory-section" id="theory-section">
                <div class="theory-header" onclick="toggleTheory()">
                    <div class="theory-header-content">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                        </svg>
                        <span class="theory-header-title">Base Conceitual</span>
                    </div>
                    <span class="theory-toggle">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"/>
                        </svg>
                    </span>
                </div>
                <div class="theory-body">
                    \${lesson.content}
                </div>
            </div>

            <!-- Navigation -->
            <div class="lesson-navigation">
                <button class="nav-button" onclick="navigatePrev()" \${getPrevLesson() ? '' : 'disabled'}>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"/>
                    </svg>
                    Anterior
                </button>
                <button class="nav-button" onclick="navigateNext()" \${getNextLesson() ? '' : 'disabled'}>
                    Proxima
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9 18 15 12 9 6"/>
                    </svg>
                </button>
            </div>
        \`;
    }

    // ===== THEORY TOGGLE =====
    function toggleTheory() {
        const section = document.getElementById('theory-section');
        section.classList.toggle('expanded');
    }

    // ===== NAVIGATION HELPERS =====
    function getPrevLesson() {
        const idx = lessonOrder.indexOf(currentLesson);
        return idx > 0 ? lessonOrder[idx - 1] : null;
    }

    function getNextLesson() {
        const idx = lessonOrder.indexOf(currentLesson);
        return idx < lessonOrder.length - 1 ? lessonOrder[idx + 1] : null;
    }

    function navigatePrev() {
        const prev = getPrevLesson();
        if (prev) loadLesson(prev);
    }

    function navigateNext() {
        const next = getNextLesson();
        if (next) loadLesson(next);
    }

    // ===== EVENT LISTENERS =====
    function setupEventListeners() {
        // Theme toggle
        document.getElementById('theme-toggle').addEventListener('click', toggleTheme);

        // Sidebar toggle (mobile)
        document.getElementById('sidebar-toggle').addEventListener('click', () => {
            document.getElementById('sidebar').classList.toggle('open');
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', handleKeyboard);

        // Close modal on outside click
        document.getElementById('shortcuts-modal').addEventListener('click', (e) => {
            if (e.target.classList.contains('modal-overlay')) {
                closeModal();
            }
        });
    }

    function handleKeyboard(e) {
        // Ignore if typing in input
        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

        switch(e.key.toLowerCase()) {
            case 'j':
                navigateNext();
                break;
            case 'k':
                navigatePrev();
                break;
            case 'b':
                document.getElementById('sidebar').classList.toggle('open');
                break;
            case 't':
                toggleTheme();
                break;
            case '?':
                document.getElementById('shortcuts-modal').classList.toggle('active');
                break;
            case 'escape':
                closeModal();
                break;
        }
    }

    function closeModal() {
        document.getElementById('shortcuts-modal').classList.remove('active');
    }

    // ===== THEME =====
    function toggleTheme() {
        const html = document.documentElement;
        const current = html.getAttribute('data-theme');
        const next = current === 'light' ? 'dark' : 'light';
        html.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
    }

    function loadTheme() {
        const saved = localStorage.getItem('theme');
        if (saved) {
            document.documentElement.setAttribute('data-theme', saved);
        }
    }

    // ===== SERVICE WORKER =====
    function registerServiceWorker() {
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(reg => console.log('SW registered'))
                .catch(err => console.log('SW registration failed:', err));
        }
    }
    </script>
</body>
</html>
